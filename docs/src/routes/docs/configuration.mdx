# Configuration

Learn how to configure Tombi using the `tombi.toml` configuration file.

## Configuration File

Tombi uses a TOML configuration file named `tombi.toml`.
Also, we supports `[tool.tombi]` in `pyproject.toml`.

### Search Priority

1. `tombi.toml` in the current directory
2. `[tool.tombi]` in `pyproject.toml` in the current directory
3. ...search parent directory recursively
4. `$XDG_CONFIG_HOME/tombi/config.toml`
5. `~/.config/tombi/config.toml`
6. `~/Library/Application Support/tombi/config.toml` (macOS), `%APPDATA%\tombi\config.toml` (Windows)
7. `/etc/tombi/config.toml` (Linux)

## Full Structure

```toml
toml-version = "1.0.0"

[files]
include = ["**/*.toml"]
exclude = []

[format]

[lint]
[lint.rules]
dotted-keys-out-of-order = "warn"
key-empty = "warn"
tables-out-of-order = "warn"

[lsp]
code-action.enabled = true
completion.enabled = true
diagnostics.enabled = true
document-link.enabled = true
formatting.enabled = true
goto-declaration.enabled = true
goto-definition.enabled = true
goto-type-definition.enabled = true
hover.enabled = true
workspace-diagnostic.enabled = true

[schema]
enabled = true
strict = true
catalog = {
  paths = [
    "tombi://json.schemastore.org/api/json/catalog.json",
    "https://json.schemastore.org/api/json/catalog.json",
  ],
}

# Root Schema
[[schemas]]
toml-version = "1.0.0"
path = "https://example.com/schema.json"
include = ["example.toml"]

# Sub Schema
[[schemas]]
root = "tool.taskipy"
path = "schemas/partial-taskipy.schema.json"
include = ["pyproject.toml"]
```

## Configuration Options

- [toml-version](#toml-version)
- [files](#files)
  - [files.include](#filesinclude)
  - [files.exclude](#filesexclude)
- [format](#format)
- [lint](#lint)
  - [lint.rules](#lintrules)
    - [lint.rules.key-empty](#lintruleskey-empty)
    - [lint.rules.dotted-keys-out-of-order](#lintrulesdotted-keys-out-of-order)
    - [lint.rules.tables-out-of-order](#lintrulestables-out-of-order)
- [lsp](#lsp)
  - [lsp.code-action](#lspcode-action)
    - [lsp.code-action.enabled](#lspcode-actionenabled)
  - [lsp.completion](#lspcompletion)
    - [lsp.completion.enabled](#lspcompletionenabled)
  - [lsp.diagnostic](#lspdiagnostic)
    - [lsp.diagnostic.enabled](#lspdiagnosticenabled)
  - [lsp.document-link](#lspdocument-link)
    - [lsp.document-link.enabled](#lspdocument-linkenabled)
  - [lsp.formatting](#lspformatting)
    - [lsp.formatting.enabled](#lspformattingenabled)
  - [lsp.goto-declaration](#lspgoto-declaration)
    - [lsp.goto-declaration.enabled](#lspgoto-declarationenabled)
  - [lsp.goto-definition](#lspgoto-definition)
    - [lsp.goto-definition.enabled](#lspgoto-definitionenabled)
  - [lsp.goto-type-definition](#lspgoto-type-definition)
    - [lsp.goto-type-definition.enabled](#lspgoto-type-definitionenabled)
  - [lsp.hover](#lsphover)
    - [lsp.hover.enabled](#lsphoverenabled)
  - [lsp.workspace-diagnostic](#lspworkspace-diagnostic)
    - [lsp.workspace-diagnostic.enabled](#lspworkspace-diagnosticenabled)
- [schema](#schema)
  - [schema.enabled](#schemaenabled)
  - [schema.strict](#schemastrict)
  - [schema.catalog](#schemacatalog)
    - [schema.catalog.paths](#schemacatalogpaths)
- [schemas](#schemas)
  - [schemas[*].toml-version](#root-schema)
  - [schemas[*].root](#sub-schema)
  - [schemas[*].path](#root-schema)
  - [schemas[*].include](#root-schema)

### `toml-version`

Specifies the TOML version to use if not specified in the schema and comment directive.

- Type: `string`
- Default: `"v1.0.0"`
- Valid values: `"v1.0.0"`, `"v1.1.0-preview"`

### `files`

Configure file patterns for formatting and linting operations.

### `files.include`

The file match pattern to include in formatting and linting. Supports glob pattern.

- Type: `string[]`
- Default: `["**/*.toml"]`

### `files.exclude`

The file match pattern to exclude from formatting and linting. Supports glob pattern.

- Type: `string[]`

### `format`

Formatter options. To avoid needless discussion of formatting rules, we do not currently have a configuration item for formatting.

### `lint`

Linter options for TOML files.

### `lint.rules`

Configure individual lint rules with severity levels.

### `lint.rules.key-empty`

Check if the key is empty.

- Type: `"off" | "warn" | "error"`
- Default: `"warn"`

```toml
# VALID BUT DISCOURAGED
"" = true
```

### `lint.rules.dotted-keys-out-of-order`

Check if dotted keys are defined out of order.

- Type: `"off" | "warn" | "error"`
- Default: `"warn"`

```toml
# VALID BUT DISCOURAGED
apple.type = "fruit"
orange.type = "fruit"
apple.skin = "thin"
orange.skin = "thick"

# RECOMMENDED
apple.type = "fruit"
apple.skin = "thin"
orange.type = "fruit"
orange.skin = "thick"
```

### `lint.rules.tables-out-of-order`

Check if tables are defined out of order.

- Type: `"off" | "warn" | "error"`
- Default: `"warn"`

```toml
# VALID BUT DISCOURAGED
[fruit.apple]
[animal]
[fruit.orange]

# RECOMMENDED
[fruit.apple]
[fruit.orange]
[animal]
```

### `lsp`

Language Server Protocol (LSP) feature configuration. Each feature can be individually enabled or disabled.

### `lsp.code-action`

Configure code action feature.

#### `lsp.code-action.enabled`

Enable or disable code action feature.

- Type: `boolean`
- Default: `true`

### `lsp.completion`

Configure completion feature.

#### `lsp.completion.enabled`

Enable or disable completion feature.

- Type: `boolean`
- Default: `true`

### `lsp.diagnostic`

Configure diagnostic feature.

#### `lsp.diagnostic.enabled`

Enable or disable diagnostic feature.

- Type: `boolean`
- Default: `true`

### `lsp.document-link`

Configure document link feature.

#### `lsp.document-link.enabled`

Enable or disable document link feature.

- Type: `boolean`
- Default: `true`

### `lsp.formatting`

Configure formatting feature.

#### `lsp.formatting.enabled`

Enable or disable formatting feature.

- Type: `boolean`
- Default: `true`

### `lsp.goto-declaration`

Configure goto declaration feature.

#### `lsp.goto-declaration.enabled`

Enable or disable goto declaration feature.

- Type: `boolean`
- Default: `true`

### `lsp.goto-definition`

Configure goto definition feature.

#### `lsp.goto-definition.enabled`

Enable or disable goto definition feature.

- Type: `boolean`
- Default: `true`

### `lsp.goto-type-definition`

Configure goto type definition feature.

#### `lsp.goto-type-definition.enabled`

Enable or disable goto type definition feature.

- Type: `boolean`
- Default: `true`

### `lsp.hover`

Configure hover feature.

#### `lsp.hover.enabled`

Enable or disable hover feature.

- Type: `boolean`
- Default: `true`

### `lsp.workspace-diagnostic`

Configure workspace diagnostic feature.

#### `lsp.workspace-diagnostic.enabled`

Enable or disable workspace diagnostic feature.

- Type: `boolean`
- Default: `true`

### `schema`

JSON Schema validation options for TOML files.

### `schema.enabled`

Enable or disable schema validation.

- Type: `boolean`
- Default: `true`

### `schema.strict`

Enable strict schema validation. If `additionalProperties` is not specified in the JSON Schema, the strict mode treats it as `additionalProperties: false`, which is different from the JSON Schema specification.

- Type: `boolean`
- Default: `true`

### `schema.catalog`

Configure schema catalog for automatic schema detection.

### `schema.catalog.paths`

The schema catalog path/url array. The catalog is evaluated after the schemas specified by `[[schemas]]`. Schemas are loaded in order from the beginning of the catalog list.

- Type: `string[]`
- Default: `["tombi://json.schemastore.org/api/json/catalog.json", "https://json.schemastore.org/api/json/catalog.json"]`

### `schemas`

Define custom schemas for specific TOML files. You can specify both root schemas and sub-schemas.

#### Root Schema

Apply a schema to the entire TOML document.

```toml
[[schemas]]
toml-version = "v1.0.0"  # optional
path = "https://example.com/schema.json"
include = ["example.toml"]
```

- `toml-version`(optional): The TOML version that the schema is available for
- `path`: The schema path (URL or local file path)
- `include`: File match patterns to apply this schema (supports glob patterns)

#### Sub Schema

Apply a schema to a specific part of the TOML document.
Sub schemas are mainly provided for configuring extension features, such as the [tool section](https://peps.python.org/pep-0518/#tool-table) in `pyproject.toml` or similar cases where only part of the document should be validated or structured according to an additional schema.

```toml
[[schemas]]
root = "tool.taskipy"
path = "schemas/partial-taskipy.schema.json"
include = ["pyproject.toml"]
```

- `root`: The accessor path to apply the sub-schema (e.g., `"tools.tombi"`, `"items[0].name"`)
- `path`: The schema path (URL or local file path)
- `include`: File match patterns to apply this schema (supports glob patterns)
